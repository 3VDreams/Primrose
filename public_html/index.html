<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
        <title>Primrose: Canvas-based text editor</title>
        <style type="text/css">
            canvas{
                border:dashed 3px red;
            }
            body{
                background-color: #eee;
            }
        </style>
        <style type="text/css" id="testStyle">
            #testDoc{
                font-family: monospace;
                color:black;
            }
            #testDoc .keyword{
                color: blue;
            }
            #testDoc .identifier{
                color: #aa0000;
                font-weight: bold;
            }
            #testDoc .stringLiteral{
                color: #aa9900;
                font-style: italic;
            }
            #testDoc .comment{
                color: green;
                font-style: italic;
            }
            #testDoc .openParen, .closeParen, .openBrace, .closeBrace{
                color: black;
            }
        </style>
    </head>
    <body>
        <canvas id="output" width="1000" height="300"></canvas>

        <script type="text/javascript">
            // scrounge setup
            var testText = "function Hello (){\n"
                    + "    // a comment\n"
                    + "    function MyFunc ( ) {\n"
                    + "        var x = \"Whatever\";\n"
                    + "        console.log(x + \" World\");\n"
                    + "        /*\n"
                    + "          a longer comment\n"
                    + "        */\n"
                    + "    }\n"
                    + "}";
            var testDoc = document.getElementById("testDoc");
            var output = document.getElementById("output");
            var graphics = output.getContext("2d");
            var HEIGHT = 20;
            var cursor = {x: 0, y: 0};
            graphics.font = HEIGHT + "px monospace";
            var WIDTH = graphics.measureText("M").width;
            var testStyleSheet = null;
            for (var i = 0; i < document.styleSheets.length; ++i) {
                var s = document.styleSheets[i];
                if (s.ownerNode.id === "testStyle") {
                    testStyleSheet = s;
                    break;
                }
            }

            var javascriptGrammar = {
                escapeAmpersands: function (txt) {
                    return txt.replace(/&/g, "&amp;");
                },
                escapeEscapedQuote: function (txt) {
                    return txt.replace(/\\"/g, "&quot;");
                },
                replaceSpaces: function (txt) {
                    return txt.replace(/ /g, "&nbsp;");
                },
                escapeStrings: function (txt, state) {
                    return txt.replace(/"[^"]+"/g, function (match) {
                        var i = state.strings.length;
                        state.strings[i] = match;
                        return "&string" + i + ";";
                    });
                },
                escapeComments1: function(txt, state){
                    return txt.replace(/\/\/[^\n]+\n/g, function(match){
                        var i = state.comments.length;
                        state.comments[i] = match;
                        return "&comment" + i + ";";
                    });
                },
                escapeComments2: function(txt, state){
                    return txt.replace(/\/\*(\/(?!\*)|[^\/])+\*\//g, function(match){
                        var i = state.comments.length;
                        state.comments[i] = match;
                        return "&comment" + i + ";";
                    });
                },
                escapeKeywords: function (txt) {
                    return txt.replace(/\b(break|case|catch|const|continue|debugger|default|delete|do|else|export|finally|for|function|if|import|in|instanceof|let|new|return|super|switch|this|throw|try|typeof|var|void|while|with)\b/g, function (match, groups) {
                        return "&" + match + ";";
                    });
                },
                replaceIdentifiers: function (txt) {
                    return txt.replace(/(\w+)/g, function (match, groups, i) {
                        if (txt[i - 1] === "&") {
                            return match;
                        }
                        return "<span class=\"identifier\">" + match + "</span>";
                    });
                },
                replaceKeywords: function (txt) {
                    return txt.replace(/&(break|case|catch|const|continue|debugger|default|delete|do|else|export|finally|for|function|if|import|in|instanceof|let|new|return|super|switch|this|throw|try|typeof|var|void|while|with);/g, function (match, groups) {
                        return "<span class=\"keyword\">" + groups + "</span>";
                    });
                },
                replaceStrings: function (txt, state) {
                    return txt.replace(/&string(\d+);/g, function (match, groups) {
                        return "<span class=\"stringLiteral\">" + state.strings[groups] + "</span>";
                    });
                },
                replaceComments: function (txt, state) {
                    return txt.replace(/&comment(\d+);/g, function (match, groups) {
                        return "<span class=\"comment\">" + state.comments[groups] + "</span>";
                    });
                },
                replaceNewlines: function (txt) {
                    return txt.replace(/\r?\n/g, "<br>");
                },
                replaceEscapedQuote: function (txt) {
                    return txt.replace(/&quot;/g, "\\\"");
                },
                replaceAmerpsands: function (txt) {
                    return txt.replace(/&amp;/g, "&");
                }
            };

            // flatten DOM tree and prepare nodes for cascade calc
            function computeStyles(doc, styleSheet) {
                var rules = styleSheet.rules;
                var parent = doc.parentNode;
                if (!parent) {
                    parent = document.createElement("div");
                    if (typeof (doc) === "string") {
                        var temp = doc;
                        doc = document.createElement("div");
                        doc.innerHTML = temp;
                        doc.id = "testDoc";
                    }
                    else {
                        parent.id = "testDoc";
                    }
                    parent.appendChild(doc);
                }
                var allNodes = [doc];
                var textNodes = [];
                for (var i = 0; i < allNodes.length; ++i) {
                    var cur = allNodes[i];
                    cur.totalStyle = {};
                    if (cur.nodeType === Element.TEXT_NODE) {
                        textNodes.push(cur);
                        cur.text = cur.nodeValue
                                .replace(/( |\n|\r)/g, "")
                                .replace(/&nbsp;/g, " ");
                    }
                    else if (cur.tagName === "BR") {
                        textNodes.push("\n");
                    }
                    allNodes.splice.bind(allNodes, i + 1, 0).apply(allNodes, cur.childNodes);
                }

                // start with stylesheet rules first, later rules
                // will be able to replace early rules
                for (var i = 0; i < rules.length; ++i) {
                    var rule = rules[i];

                    // find the nodes this applies to and apply the rule
                    var tags = parent.querySelectorAll(rule.selectorText);
                    for (var j = 0; j < rule.style.length; ++j) {
                        var style = rule.style[j];
                        var def = rule.style[style];
                        if (rule.style.hasOwnProperty(style) && def) {
                            for (var k = 0; k < tags.length; ++k) {
                                var cur = tags[k];
                                cur.totalStyle[style] = def;
                            }
                        }
                    }
                }

                // cascade down the rules of the parent nodes and overwrite the
                // stylesheet rules with the inline rules
                for (var i = 0; i < allNodes.length; ++i) {
                    var cur = allNodes[i];
                    for (var j = 0; j < cur.childNodes.length; ++j) {
                        var child = cur.childNodes[j];
                        if (child.style) {
                            for (var k = 0; k < child.style.length; ++k) {
                                child.totalStyle[child.style[k]] = child.style[child.style[k]];
                            }
                        }
                        for (var key in child.parentNode.totalStyle) {
                            if (!child.totalStyle[key]) {
                                child.totalStyle[key] = child.parentNode.totalStyle[key];
                            }
                        }
                    }
                }
                return textNodes;
            }

            function drawText(g, textNodes, cursor) {
                g.clearRect(0, 0, g.canvas.width, g.canvas.height);
                var x = 0, y = 0;
                for (var i = 0; i < textNodes.length; ++i) {
                    var cur = textNodes[i];
                    if (cur === "\n") {
                        x = 0;
                        ++y;
                    }
                    else {
                        var font = ((cur.totalStyle["font-weight"] || "")
                                + " "
                                + (cur.totalStyle["font-style"] || "")
                                + " "
                                + HEIGHT
                                + "px monospace").trim();
                        g.font = font;
                        g.fillStyle = cur.totalStyle.color;
                        var txt = cur.nodeValue
                                .replace(/( |\n|\r)/g, "")
                                .replace(/&nbsp;/g, " ");
                        g.fillText(txt, x * WIDTH, (y + 1) * HEIGHT);
                        x += txt.length;
                    }
                }
                g.beginPath();
                g.strokeStyle = "black";
                g.moveTo(cursor.x * WIDTH, cursor.y * HEIGHT);
                g.lineTo(cursor.x * WIDTH, (cursor.y + 1.25) * HEIGHT);
                g.moveTo(cursor.x * WIDTH + 1, cursor.y * HEIGHT);
                g.lineTo(cursor.x * WIDTH + 1, (cursor.y + 1.25) * HEIGHT);
                g.stroke();
            }

            function parseTextToHTML(text, grammar) {
                var state = {
                    strings: [],
                    comments: []
                };
                for (var key in grammar) {
                    text = grammar[key](text, state);
                }
                return text;
            }

            function editText(text, cursor, evt) {
                var lines = text.split("\n");

                var key = event.keyCode;
                if (key === KeyboardInput.BACKSPACE) {
                    evt.preventDefault();
                    if (cursor.x === 0) {
                        if(cursor.y > 0){
                            cursor.x = lines[cursor.y - 1].length;
                            lines[cursor.y - 1] += lines[cursor.y];
                            lines.splice(cursor.y, 1);
                            --cursor.y;
                        }
                    }
                    else {
                        lines[cursor.y] = lines[cursor.y].substring(0, cursor.x - 1)
                                + lines[cursor.y].substring(cursor.x);
                        --cursor.x;
                    }
                }
                else if (key === KeyboardInput.DELETE) {
                    if (cursor.x === lines[cursor.y].length) {
                        if(cursor.y < lines.length - 1){
                            lines[cursor.y] += lines[cursor.y + 1];
                            lines.splice(cursor.y + 1, 1);
                        }
                    }
                    else {
                        lines[cursor.y] = lines[cursor.y].substring(0, cursor.x)
                                + lines[cursor.y].substring(cursor.x + 1);
                    }
                }
                else if (key === KeyboardInput.LEFTARROW) {
                    --cursor.x;
                }
                else if (key === KeyboardInput.RIGHTARROW) {
                    ++cursor.x;
                }
                else if (key === KeyboardInput.UPARROW) {
                    --cursor.y;
                }
                else if (key === KeyboardInput.DOWNARROW) {
                    ++cursor.y;
                }
                else if (key === KeyboardInput.HOME) {
                    if(evt.ctrlKey){
                        cursor.y = 0;
                    }
                    cursor.x = 0;
                }
                else if (key === KeyboardInput.END) {
                    if(evt.ctrlKey){
                        cursor.y = lines.length - 1;
                    }
                    cursor.x = lines[cursor.y].length;
                }
                else if (key === KeyboardInput.PAGEUP) {
                    cursor.y -= 10;
                }
                else if (key === KeyboardInput.PAGEDOWN) {
                    cursor.y += 10;
                }
                else if (key === KeyboardInput.ENTER) {
                    lines.splice(cursor.y + 1, 0, lines[cursor.y].substring(cursor.x));
                    lines[cursor.y] = lines[cursor.y].substring(0, cursor.x);
                    ++cursor.y;
                    cursor.x = 0;
                    while(lines[cursor.y-1][cursor.x] === " "){
                        lines[cursor.y] += " ";
                        ++cursor.x;
                    }
                }
                else if (key === KeyboardInput.TAB){
                    evt.preventDefault();
                    lines[cursor.y] = lines[cursor.y].substring(0, cursor.x)
                            + "    "
                            + lines[cursor.y].substring(cursor.x);
                    cursor.x += 4;
                }
                else if (event.shiftKey && KeyboardInput.UPPERCASE[key]) {
                    lines[cursor.y] = lines[cursor.y].substring(0, cursor.x)
                            + KeyboardInput.UPPERCASE[key]
                            + lines[cursor.y].substring(cursor.x);
                    ++cursor.x;
                }
                else if (!event.shiftKey && KeyboardInput.LOWERCASE[key]) {
                    lines[cursor.y] = lines[cursor.y].substring(0, cursor.x)
                            + KeyboardInput.LOWERCASE[key]
                            + lines[cursor.y].substring(cursor.x);
                    ++cursor.x;
                }
                else {
                    console.log(event.keyCode);
                }
                
                return lines;
            }
            
            function fixCursor(cursor, lines){

                if (cursor.y < 0) {
                    cursor.y = 0;
                }
                else if (cursor.y > lines.length - 1) {
                    cursor.y = lines.length - 1;
                }
                
                if (cursor.x > lines[cursor.y].length) {
                    if (cursor.y < lines.length - 1) {
                        cursor.x = 0;
                        ++cursor.y;
                    }
                    else {
                        --cursor.x;
                    }
                }
                else if (cursor.x < 0) {
                    if (cursor.y > 0) {
                        --cursor.y;
                        cursor.x = lines[cursor.y].length;
                    }
                    else {
                        ++cursor.x;
                    }
                }
            }

            function refresh() {
                var doc = parseTextToHTML(testText, javascriptGrammar);
                var parts = computeStyles(doc, testStyleSheet);
                drawText(graphics, parts, cursor);
            }

            window.addEventListener("keydown", function (evt) {
                var lines = editText(testText, cursor, evt);
                fixCursor(cursor, lines);
                testText = lines.join("\n");
                refresh();
            });
            
            refresh();
            
            output.addEventListener("mousedown", function (evt){
                cursor.y = Math.floor(evt.layerY / HEIGHT);
                cursor.x = Math.floor(evt.layerX / WIDTH);
                var lines = testText.split("\n");
                fixCursor(cursor, lines);
                testText = lines.join("\n");
                refresh();
            });

            var KeyboardInput = {};
            KeyboardInput.BACKSPACE = 8;
            KeyboardInput.TAB = 9;
            KeyboardInput.ENTER = 13;
            KeyboardInput.SHIFT = 16;
            KeyboardInput.CTRL = 17;
            KeyboardInput.ALT = 18;
            KeyboardInput.PAUSEBREAK = 19;
            KeyboardInput.CAPSLOCK = 20;
            KeyboardInput.ESCAPE = 27;
            KeyboardInput.SPACEBAR = 32;
            KeyboardInput.PAGEUP = 33;
            KeyboardInput.PAGEDOWN = 34;
            KeyboardInput.END = 35;
            KeyboardInput.HOME = 36;
            KeyboardInput.LEFTARROW = 37;
            KeyboardInput.UPARROW = 38;
            KeyboardInput.RIGHTARROW = 39;
            KeyboardInput.DOWNARROW = 40;
            KeyboardInput.INSERT = 45;
            KeyboardInput.DELETE = 46;
            KeyboardInput.NUMBER0 = 48;
            KeyboardInput.NUMBER1 = 49;
            KeyboardInput.NUMBER2 = 50;
            KeyboardInput.NUMBER3 = 51;
            KeyboardInput.NUMBER4 = 52;
            KeyboardInput.NUMBER5 = 53;
            KeyboardInput.NUMBER6 = 54;
            KeyboardInput.NUMBER7 = 55;
            KeyboardInput.NUMBER8 = 56;
            KeyboardInput.NUMBER9 = 57;
            KeyboardInput.A = 65;
            KeyboardInput.B = 66;
            KeyboardInput.C = 67;
            KeyboardInput.D = 68;
            KeyboardInput.E = 69;
            KeyboardInput.F = 70;
            KeyboardInput.G = 71;
            KeyboardInput.H = 72;
            KeyboardInput.I = 73;
            KeyboardInput.J = 74;
            KeyboardInput.K = 75;
            KeyboardInput.L = 76;
            KeyboardInput.M = 77;
            KeyboardInput.N = 78;
            KeyboardInput.O = 79;
            KeyboardInput.P = 80;
            KeyboardInput.Q = 81;
            KeyboardInput.R = 82;
            KeyboardInput.S = 83;
            KeyboardInput.T = 84;
            KeyboardInput.U = 85;
            KeyboardInput.V = 86;
            KeyboardInput.W = 87;
            KeyboardInput.X = 88;
            KeyboardInput.Y = 89;
            KeyboardInput.Z = 90;
            KeyboardInput.LEFTWINDOWKEY = 91;
            KeyboardInput.RIGHTWINDOWKEY = 92;
            KeyboardInput.SELECTKEY = 93;
            KeyboardInput.NUMPAD0 = 96;
            KeyboardInput.NUMPAD1 = 97;
            KeyboardInput.NUMPAD2 = 98;
            KeyboardInput.NUMPAD3 = 99;
            KeyboardInput.NUMPAD4 = 100;
            KeyboardInput.NUMPAD5 = 101;
            KeyboardInput.NUMPAD6 = 102;
            KeyboardInput.NUMPAD7 = 103;
            KeyboardInput.NUMPAD8 = 104;
            KeyboardInput.NUMPAD9 = 105;
            KeyboardInput.MULTIPLY = 106;
            KeyboardInput.ADD = 107;
            KeyboardInput.SUBTRACT = 109;
            KeyboardInput.DECIMALPOINT = 110;
            KeyboardInput.DIVIDE = 111;
            KeyboardInput.F1 = 112;
            KeyboardInput.F2 = 113;
            KeyboardInput.F3 = 114;
            KeyboardInput.F4 = 115;
            KeyboardInput.F5 = 116;
            KeyboardInput.F6 = 117;
            KeyboardInput.F7 = 118;
            KeyboardInput.F8 = 119;
            KeyboardInput.F9 = 120;
            KeyboardInput.F10 = 121;
            KeyboardInput.F11 = 122;
            KeyboardInput.F12 = 123;
            KeyboardInput.NUMLOCK = 144;
            KeyboardInput.SCROLLLOCK = 145;
            KeyboardInput.SEMICOLON = 186;
            KeyboardInput.EQUALSIGN = 187;
            KeyboardInput.COMMA = 188;
            KeyboardInput.DASH = 189;
            KeyboardInput.PERIOD = 190;
            KeyboardInput.FORWARDSLASH = 191;
            KeyboardInput.GRAVEACCENT = 192;
            KeyboardInput.OPENBRACKET = 219;
            KeyboardInput.BACKSLASH = 220;
            KeyboardInput.CLOSEBRACKET = 221;
            KeyboardInput.SINGLEQUOTE = 222;

            KeyboardInput.LOWERCASE = {};
            KeyboardInput.LOWERCASE[KeyboardInput.A] = "a";
            KeyboardInput.LOWERCASE[KeyboardInput.B] = "b";
            KeyboardInput.LOWERCASE[KeyboardInput.C] = "c";
            KeyboardInput.LOWERCASE[KeyboardInput.D] = "d";
            KeyboardInput.LOWERCASE[KeyboardInput.E] = "e";
            KeyboardInput.LOWERCASE[KeyboardInput.F] = "f";
            KeyboardInput.LOWERCASE[KeyboardInput.G] = "g";
            KeyboardInput.LOWERCASE[KeyboardInput.H] = "h";
            KeyboardInput.LOWERCASE[KeyboardInput.I] = "i";
            KeyboardInput.LOWERCASE[KeyboardInput.J] = "j";
            KeyboardInput.LOWERCASE[KeyboardInput.K] = "k";
            KeyboardInput.LOWERCASE[KeyboardInput.L] = "l";
            KeyboardInput.LOWERCASE[KeyboardInput.M] = "m";
            KeyboardInput.LOWERCASE[KeyboardInput.N] = "n";
            KeyboardInput.LOWERCASE[KeyboardInput.O] = "o";
            KeyboardInput.LOWERCASE[KeyboardInput.P] = "p";
            KeyboardInput.LOWERCASE[KeyboardInput.Q] = "q";
            KeyboardInput.LOWERCASE[KeyboardInput.R] = "r";
            KeyboardInput.LOWERCASE[KeyboardInput.S] = "s";
            KeyboardInput.LOWERCASE[KeyboardInput.T] = "t";
            KeyboardInput.LOWERCASE[KeyboardInput.U] = "u";
            KeyboardInput.LOWERCASE[KeyboardInput.V] = "v";
            KeyboardInput.LOWERCASE[KeyboardInput.W] = "w";
            KeyboardInput.LOWERCASE[KeyboardInput.X] = "x";
            KeyboardInput.LOWERCASE[KeyboardInput.Y] = "y";
            KeyboardInput.LOWERCASE[KeyboardInput.Z] = "z";
            KeyboardInput.LOWERCASE[KeyboardInput.SPACEBAR] = " ";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER0] = "0";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER1] = "1";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER2] = "2";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER3] = "3";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER4] = "4";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER5] = "5";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER6] = "6";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER7] = "7";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER8] = "8";
            KeyboardInput.LOWERCASE[KeyboardInput.NUMBER9] = "9";
            KeyboardInput.LOWERCASE[KeyboardInput.MULTIPLY] = "*";
            KeyboardInput.LOWERCASE[KeyboardInput.ADD] = "+";
            KeyboardInput.LOWERCASE[KeyboardInput.SUBTRACT] = "-";
            KeyboardInput.LOWERCASE[KeyboardInput.DECIMALPOINT] = ".";
            KeyboardInput.LOWERCASE[KeyboardInput.DIVIDE] = "/";
            KeyboardInput.LOWERCASE[KeyboardInput.SEMICOLON] = ";";
            KeyboardInput.LOWERCASE[KeyboardInput.EQUALSIGN] = "=";
            KeyboardInput.LOWERCASE[KeyboardInput.COMMA] = ",";
            KeyboardInput.LOWERCASE[KeyboardInput.DASH] = "-";
            KeyboardInput.LOWERCASE[KeyboardInput.PERIOD] = ".";
            KeyboardInput.LOWERCASE[KeyboardInput.FORWARDSLASH] = "/";
            KeyboardInput.LOWERCASE[KeyboardInput.GRAVEACCENT] = "`";
            KeyboardInput.LOWERCASE[KeyboardInput.OPENBRACKET] = "[";
            KeyboardInput.LOWERCASE[KeyboardInput.BACKSLASH] = "\\";
            KeyboardInput.LOWERCASE[KeyboardInput.CLOSEBRACKET] = "]";
            KeyboardInput.LOWERCASE[KeyboardInput.SINGLEQUOTE] = "'";

            KeyboardInput.UPPERCASE = {};
            KeyboardInput.UPPERCASE[KeyboardInput.A] = "A";
            KeyboardInput.UPPERCASE[KeyboardInput.B] = "B";
            KeyboardInput.UPPERCASE[KeyboardInput.C] = "C";
            KeyboardInput.UPPERCASE[KeyboardInput.D] = "D";
            KeyboardInput.UPPERCASE[KeyboardInput.E] = "E";
            KeyboardInput.UPPERCASE[KeyboardInput.F] = "F";
            KeyboardInput.UPPERCASE[KeyboardInput.G] = "G";
            KeyboardInput.UPPERCASE[KeyboardInput.H] = "H";
            KeyboardInput.UPPERCASE[KeyboardInput.I] = "I";
            KeyboardInput.UPPERCASE[KeyboardInput.J] = "J";
            KeyboardInput.UPPERCASE[KeyboardInput.K] = "K";
            KeyboardInput.UPPERCASE[KeyboardInput.L] = "L";
            KeyboardInput.UPPERCASE[KeyboardInput.M] = "M";
            KeyboardInput.UPPERCASE[KeyboardInput.N] = "N";
            KeyboardInput.UPPERCASE[KeyboardInput.O] = "O";
            KeyboardInput.UPPERCASE[KeyboardInput.P] = "P";
            KeyboardInput.UPPERCASE[KeyboardInput.Q] = "Q";
            KeyboardInput.UPPERCASE[KeyboardInput.R] = "R";
            KeyboardInput.UPPERCASE[KeyboardInput.S] = "S";
            KeyboardInput.UPPERCASE[KeyboardInput.T] = "T";
            KeyboardInput.UPPERCASE[KeyboardInput.U] = "U";
            KeyboardInput.UPPERCASE[KeyboardInput.V] = "V";
            KeyboardInput.UPPERCASE[KeyboardInput.W] = "W";
            KeyboardInput.UPPERCASE[KeyboardInput.X] = "X";
            KeyboardInput.UPPERCASE[KeyboardInput.Y] = "Y";
            KeyboardInput.UPPERCASE[KeyboardInput.Z] = "Z";
            KeyboardInput.UPPERCASE[KeyboardInput.SPACEBAR] = " ";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER0] = ")";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER1] = "!";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER2] = "@";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER3] = "#";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER4] = "$";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER5] = "%";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER6] = "^";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER7] = "&";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER8] = "*";
            KeyboardInput.UPPERCASE[KeyboardInput.NUMBER9] = "(";
            KeyboardInput.UPPERCASE[KeyboardInput.MULTIPLY] = "*";
            KeyboardInput.UPPERCASE[KeyboardInput.ADD] = "+";
            KeyboardInput.UPPERCASE[KeyboardInput.SUBTRACT] = "-";
            KeyboardInput.UPPERCASE[KeyboardInput.DECIMALPOINT] = ".";
            KeyboardInput.UPPERCASE[KeyboardInput.DIVIDE] = "/";
            KeyboardInput.UPPERCASE[KeyboardInput.SEMICOLON] = ":";
            KeyboardInput.UPPERCASE[KeyboardInput.EQUALSIGN] = "+";
            KeyboardInput.UPPERCASE[KeyboardInput.COMMA] = "<";
            KeyboardInput.UPPERCASE[KeyboardInput.DASH] = "_";
            KeyboardInput.UPPERCASE[KeyboardInput.PERIOD] = ">";
            KeyboardInput.UPPERCASE[KeyboardInput.FORWARDSLASH] = "?";
            KeyboardInput.UPPERCASE[KeyboardInput.GRAVEACCENT] = "~";
            KeyboardInput.UPPERCASE[KeyboardInput.OPENBRACKET] = "{";
            KeyboardInput.UPPERCASE[KeyboardInput.BACKSLASH] = "|";
            KeyboardInput.UPPERCASE[KeyboardInput.CLOSEBRACKET] = "}";
            KeyboardInput.UPPERCASE[KeyboardInput.SINGLEQUOTE] = "\"";
        </script>
    </body>
</html>